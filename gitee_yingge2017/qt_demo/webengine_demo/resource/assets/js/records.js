(function(t){function e(e){for(var n,r,i=e[0],c=e[1],l=e[2],d=0,f=[];d<i.length;d++)r=i[d],a[r]&&f.push(a[r][0]),a[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],n=!0,i=1;i<s.length;i++){var c=s[i];0!==a[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=s[0]))}return t}var n={},a={records:0},o=[];function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=n,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;o.push([1,"chunk-vendors","chunk-common"]),s()})({1:function(t,e,s){t.exports=s("7c0f")},"3c2a":function(t,e,s){"use strict";var n=s("95cb"),a=s.n(n);a.a},"7c0f":function(t,e,s){"use strict";s.r(e);var n,a=s("a026"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"window_con"},[n("div",{staticClass:"title"},[t._v("随堂记录")]),t.isHistory?n("div",{staticClass:"btn_back",on:{click:t.backCalendar}},[n("img",{attrs:{src:s("0e23")}}),t._v("返回")]):t._e(),n("div",{staticClass:"records"},[n("vue-scroll",t._l(t.records,function(e){return n("div",{key:e.id,staticClass:"item"},[n("div",{staticClass:"info"},[n("div",{staticClass:"info_left"},[0===e.type?n("div",{staticClass:"type"},[t._v("纸笔互动")]):1===e.type||10===e.type?n("div",{staticClass:"type"},[t._v("【随堂测】"),e.ext?n("span",[t._v(t._s(t._f("decodePaperName")(e.ext)))]):t._e()]):2===e.type?n("div",{staticClass:"type"},[t._v("判断题")]):3===e.type?n("div",{staticClass:"type"},[t._v("单选")]):4===e.type?n("div",{staticClass:"type"},[t._v("多选")]):5===e.type?n("div",{staticClass:"type"},[t._v("抢答")]):t._e(),n("div",{staticClass:"user"},[t._v(t._s(e.countStu)+"人参与，\n                                "),"uploading"===e.status&&1!==e.rate&&e.countStu?[t._v("正在上传中...")]:t._e(),1==e.type&&1!==e.rate&&e.countStu||10==e.type&&1!==e.rate&&e.countStu?[t._v("正在批改中...")]:t._e(),0==e.type&&1!==e.rate&&e.countStu?[t._v("正在统计中...")]:t._e(),e.endTime?[t._v("结束于"+t._s(t._f("formatDate")(e.endTime))+"，用时"+t._s(e.withTime))]:t._e()],2)]),1!=e.type&&10!=e.type||0!=e.countStu?n("div",{staticClass:"btn_check",on:{click:function(s){return t.checkTask(e.id,e.taskId,e.type)}}},[t._v("查看")]):t._e()]),e.countStu?n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.type||1===e.type||10===e.type,expression:"item.type === 0 || item.type === 1|| item.type === 10 "}],staticClass:"progress"},[n("div",{staticClass:"percent",style:{width:100*e.rate+"%"}})]):t._e()])}),0)],1),n("div",{staticClass:"footer"},[n("div",{staticClass:"btn_close",class:{isHistoryPadding:t.isHistory},on:{click:t.closeWindow}},[n("img",{attrs:{src:s("71e1")}})])])])])},r=[],i=s("d69d"),c=s("8271"),l=s("b8ba"),u=s.n(l),d=s("bc3a"),f=s.n(d),p=s("27ae").Base64,v={name:"App",data:function(){return{isHistory:0,records:null,taskIds:null}},filters:{formatDate:function(t){var e=new Date(t);return Object(i["a"])(e,"hh:mm")},decodePaperName:function(t){return p.decode(t.split(",")[0].split(":")[1])}},mounted:function(){window.setPercent=this.setPercent;var t=c["a"].getUrlPrams("id"),e=c["a"].getUrlPrams("isHistory");e&&(this.isHistory=e),this.getRecords(t)},methods:{backCalendar:function(){history.back()},closeWindow:function(){localStorage.removeItem("currDay"),window.cefQuery({request:"closeWindowRecords",onSuccess:function(t){console.log("invoke success response = "+t)},onFailure:function(t,e){console.log("invoke fail code = "+t+" msg:"+e)}})},getRecords:function(t){var e=this;f.a.get(u.a.api_tl+"api/selClassRecord",{params:{classingId:t}}).then(function(t){console.log(t.data.data);var s=t.data.data,a=[];if(s){var o=!0,r=!1,i=void 0;try{for(var c,l=s[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;0!==u.type&&1!==u.type&&10!==u.type||1!==u.rate&&a.push(u.taskId)}}catch(d){r=!0,i=d}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}e.records=s,e.taskIds=a}e.taskIds.length>0&&(e.getTaskData(),setInterval(function(){e.getTaskData()},1e3)),e.$once("hook:beforeDestroy",function(){clearInterval(n)})}).catch(function(t){console.log(t)})},getTaskData:function(){var t=this;this.taskIds.length>0&&f.a.get(u.a.api_qb+"statistics/getTaskDynamic",{params:{taskIds:t.taskIds.join(",")}}).then(function(e){console.log(e.data.data);var s=e.data.data,n=!0,a=!1,o=void 0;try{for(var r,i=s[Symbol.iterator]();!(n=(r=i.next()).done);n=!0){var c=r.value;console.log(c),t.setPercent(c.deviceNumbers,c.correctDeviceNumbers,c.taskId,"correcting")}}catch(l){a=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}}).catch(function(t){console.log(t)})},setPercent:function(t,e,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"uploading";console.log(t,e,s,a);for(var o=this.records,r=s,i=0;i<o.length;i++)console.log(i),o[i].taskId==r&&(this.$set(this.records[i],"countStu",t),this.$set(this.records[i],"status",a),this.$set(this.records[i],"rate",100*e/t/100));if(console.log(this.records),"correcting"===a&&t===e){var c=this.taskIds.indexOf(s);this.taskIds.splice(c,1),0===this.taskIds.length&&clearInterval(n)}},checkTask:function(t,e,s){var n="";n=0===s||1===s||10===s?e:t,console.log(n),window.cefQuery({request:"checkTask:"+n+"&"+s,onsuccess:function(t){console.log("invoke success response = "+t)},onFailure:function(t,e){console.log("invoke fail code = "+t+" msg:"+e)}})}}},y=v,h=(s("3c2a"),s("de66"),s("2877")),g=Object(h["a"])(y,o,r,!1,null,"2ec53fb9",null),_=g.exports,k=s("77a0"),m=s.n(k);s("aaf0"),s("a939");a["default"].use(m.a),a["default"].prototype.$vuescrollConfig={bar:{keepShow:!0,background:"#DDE6EE"}},a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(_)}}).$mount("#app")},"83a5":function(t,e,s){},"95cb":function(t,e,s){},de66:function(t,e,s){"use strict";var n=s("83a5"),a=s.n(n);a.a}});
//# sourceMappingURL=records.js.map