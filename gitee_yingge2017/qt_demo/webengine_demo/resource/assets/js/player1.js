(function(t){function e(e){for(var i,r,o=e[0],c=e[1],l=e[2],u=0,d=[];u<o.length;u++)r=o[u],s[r]&&d.push(s[r][0]),s[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);h&&h(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={player1:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var h=c;n.push([9,"chunk-vendors","chunk-common"]),a()})({9:function(t,e,a){t.exports=a("b430")},b430:function(t,e,a){"use strict";a.r(e);var i,s,n,r,o,c,l=a("a026"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"window_con"},[i("div",{staticClass:"btn_close",on:{click:t.closeWindow}},[i("img",{attrs:{src:a("71e1")}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isPlay&0==t.step,expression:"!isPlay&step==0"}],staticClass:"userImg",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px",marginLeft:-t.canvasWidth/2+"px"}},[i("img",{attrs:{src:t.userImg,height:"100%"}})]),t.originImg?i("div",{directives:[{name:"show",rawName:"v-show",value:t.isPlay||0!==t.step,expression:"isPlay||step!==0"}],staticClass:"userImg",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px",marginLeft:-t.canvasWidth/2+"px"}},[i("img",{attrs:{src:t.originImg+"?x-oss-process=image/resize,w_"+t.canvasHeight,height:"100%"}})]):t._e(),i("canvas",{staticClass:"board",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px",marginLeft:-t.canvasWidth/2+"px"},attrs:{id:"myCanvas",width:t.canvasWidth,height:t.canvasHeight}}),t.currStuInfo?i("div",{directives:[{name:"show",rawName:"v-show",value:t.currStuInfo.length>1,expression:"currStuInfo.length>1"}],staticClass:"arrows"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.currPageIndex>0,expression:"currPageIndex>0"}],staticClass:"arrow_left",on:{click:t.checkPre}},[i("img",{attrs:{src:a("4dc9")}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currPageIndex<t.currStuInfo.length-1,expression:"currPageIndex < currStuInfo.length-1"}],staticClass:"arrow_right",on:{click:t.checkNext}},[i("img",{attrs:{src:a("33c9")}})])]):t._e(),i("div",{staticClass:"menus",style:{width:t.canvasWidth+"px",marginLeft:-t.canvasWidth/2+"px"}},[i("div",{staticClass:"btnPlay",on:{click:t.play}},[t.isPlay?i("img",{attrs:{src:a("88ae")}}):i("img",{attrs:{src:a("df84")}})]),i("progress-bar",{attrs:{width:"100%",percent:t.percent},on:{"pbar-drag":t.setPercent,"pbar-seek":t.setPercent}}),i("div",{staticClass:"speed"},[i("span",{staticClass:"btn_speed",class:{active:1==t.speed},on:{click:function(e){return t.setSpeed(1)}}},[t._v("4X")]),i("span",{staticClass:"btn_speed",class:{active:10==t.speed},on:{click:function(e){return t.setSpeed(10)}}},[t._v("2X")]),i("span",{staticClass:"btn_speed",class:{active:20==t.speed},on:{click:function(e){return t.setSpeed(20)}}},[t._v("1X")])])],1)])])},u=[],d=a("1bd8"),p=a("8271"),g=a("3b29"),f=a("bf31"),v=a.n(f),m=a("b8ba"),y=a.n(m),w=a("bc3a"),b=a.n(w);function _(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var k=2,I=0,P=null,x=1,S=1,T=60,C={name:"App",components:{progressBar:d["a"]},data:function(){return{winHeight:0,deviceWidth:29700,deviceHeight:21e3,C5W_WIDTH:5535,C5W_HEIGHT:10100,speed:10,offset:0,currStuInfo:null,currDeviceType:-1,currPageIndex:0,taskId:"",pageCode:"",deviceMac:"",step:0,percent:0,toStep:0,userImg:"",originImg:"",trails:[],blocks:[],isPlay:!1}},computed:{canvasHeight:function(){return this.winHeight},canvasWidth:function(){return this.canvasHeight/(this.deviceWidth/this.deviceHeight)},gap:function(){return Math.ceil(100/this.trails.length)}},filters:{formatDate:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=new Date(t);return formatDate(e,"yyyy-MM-dd hh:mm")})},mounted:function(){this.taskId=p["a"].getUrlPrams("taskId"),this.pageCode=p["a"].getUrlPrams("pageCode"),this.deviceMac=p["a"].getUrlPrams("deviceMac"),this.winHeight=parseInt(p["a"].getUrlPrams("height"));var t=localStorage.getItem("playSpeed");if(t&&(this.speed=t),console.log(this.canvasWidth,this.canvasHeight),this.currPageIndex=0,this.currStuInfo){var e=!0,a=!1,i=void 0;try{for(var s,n=this.currStuInfo[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){s.value;var r=new Image;r.src=this.imgUrl;var o=new Image;o.src=this.recogImgUrl}}catch(c){a=!0,i=c}finally{try{e||null==n.return||n.return()}finally{if(a)throw i}}}this.initCanvas(),this.initData()},methods:(i={initData:function(){this.locadNoteInfo()},initCanvas:function(){var t=document.getElementById("myCanvas");P=t.getContext("2d"),P.translate(.5,.5),P.fillStyle="rgba(255, 255, 255, 0)"},closeWindow:function(){window.cefQuery({request:"closeWindowPlayer",onsuccess:function(t){console.log("invoke success response = "+t)},onFailure:function(t,e){console.log("invoke fail code = "+t+" msg:"+e)}})},setPercent:function(t){console.log(t),I=0,this.isPlay=!1,P.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.toStep=parseInt(t*this.trails.length/100),this.step=0,this.speed=0,this.playTrails()},checkPre:function(){this.currPageIndex-=1,this.initData()},checkNext:function(){this.currPageIndex+=1,this.initData()},setSpeed:function(t){this.speed=t,localStorage.setItem("playSpeed",t)},play:function(){0==this.speed&&(this.speed=10);var t=this.blockKey;t?(this.isPlay=!this.isPlay,this.isPlay&&this.playTrails()):console.log("该页没有笔迹")},playTrails:function(){var t=this.step,e=this.toStep;t<e?this.readTrails(this.trails[t].color,this.trails[t].data,0):t<this.trails.length&&this.isPlay?this.readTrails(this.trails[t].color,this.trails[t].data,0):t==this.trails.length&&(this.step=0,this.percent=0,this.toStep=0,this.isPlay=!1,P.clearRect(0,0,this.canvasWidth,this.canvasHeight))}},_(i,"closeWindow",function(){window.cefQuery({request:"closeWindowPlayer1",onSuccess:function(t){console.log("invoke success response = "+t)},onFailure:function(t,e){console.log("invoke fail code = "+t+" msg:"+e)}})}),_(i,"locadNoteInfo",function(){var t=this,e=y.a.api_trails_secret,a=y.a.api_trails_source;console.log(a);var i=y.a.api_trails+"notes/item_for_title",s={user_id:a,source:a,user_key:this.deviceMac,title:this.taskId,paper_code:this.pageCode,e:Date.parse(new Date)/1e3},n=g["a"].getToken(i,e,s);b.a.post(y.a.api_trails+"notes/item_for_title",{user_id:a,source:a,user_key:this.deviceMac,title:this.taskId,paper_code:this.pageCode,e:Date.parse(new Date)/1e3,token:n}).then(function(e){if(e.data){console.log(e.data);var a=e.data.data[0].blend_img,i=e.data.data[0].paper_img,s=e.data.data[0].note_key,n=e.data.data[0].block_key;t.userImg=a,t.originImg=i,t.blockKey=n,t.noteKey=s,t.locadBlocks(s,n)}}).catch(function(t){console.log(t)})}),_(i,"locadBlocks",function(t,e){var a=this,i=y.a.api_trails_secret,s=y.a.api_trails_source,n=y.a.api_trails+"trails/block",r={source:s,note_key:t,block_key:e,limit:500,offset:a.offset,e:Date.parse(new Date)/1e3},o=g["a"].getToken(n,i,r);b.a.post(y.a.api_trails+"trails/block",{source:s,note_key:t,block_key:e,limit:500,offset:a.offset,e:Date.parse(new Date)/1e3,token:o}).then(function(t){var e=t.data.data;if(a.offset+=e.length,null!=e&&e.length>0){var i=[];null==e&&(e=[]),e.forEach(function(t){t.data&&(t.data=new DataView(v.a.decode(t.data.replace(/-/g,"+").replace(/_/g,"/"))),i.push(t))}),a.trails=i,500===e.length&&a.locadBlocks()}a.blocks=a.blocks.concat(e)}).catch(function(t){console.log(t)})}),_(i,"drawTrails",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-65536,e=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,h=x*e,u=S*a,d=i,p=(t+4294967296).toString(16).substr(-6);if(0===t?(P.globalCompositeOperation="destination-out",d=10*i):P.globalCompositeOperation="source-over",P.setLineCap="round",16==l||0==l)return this.isStart>0&&(this.isStart>1?P.lineTo(s,n):P.lineTo(s+1,n+1),P.setLineWidth(r),P.stroke()),void(I=0);if(I>0){o=x*e,c=S*a;var g=Math.sqrt(Math.pow(s-o,2)+Math.pow(n-c,2));g>k&&(h=Math.round((s+o)/2*100)/100,u=Math.round((n+c)/2*100)/100,1==I?P.lineTo(h,u):(P.quadraticCurveTo(s,n,h,u),P.lineWidth=d,P.stroke(),P.beginPath(),P.moveTo(h,u)),s=o,n=c),I++}else P.beginPath(),P.lineCap="round",P.strokeStyle="#"+p,s=h,n=u,P.moveTo(h,u),I++}),_(i,"readTrails",function(t,e){var a,i,s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this,o=this.currDeviceType;(this.isDrawTrails=!0,e.byteLength>n)?(o===T?(a=e.getFloat32(n,!0)*this.canvasWidth/10500,i=e.getFloat32(n+4,!0)*(this.canvasHeight/2.25)/6350,s=e.getFloat32(n+8,!0)*this.canvasWidth/10500):(a=e.getFloat32(n,!0)*this.canvasWidth/21e3,i=e.getFloat32(n+4,!0)*this.canvasHeight/29700,s=e.getFloat32(n+8,!0)*this.canvasWidth/21e3),this.drawTrails(t,a,i,s,17),this.speed?setTimeout(function(){n+=20,r.readTrails(t,e,n)},this.speed):(n+=20,r.readTrails(t,e,n))):(this.drawTrails(t,0,0,0,0),this.isDrawTrails=!1,this.step++,this.speed?setTimeout(function(){r.playTrails()},this.speed):r.playTrails());this.percent=100*this.step/this.trails.length}),i)},W=C,D=(a("fb98"),a("f22c"),a("2877")),H=Object(D["a"])(W,h,u,!1,null,"3627260c",null),M=H.exports;a("a939");l["default"].config.productionTip=!1,new l["default"]({render:function(t){return t(M)}}).$mount("#app")},c19c:function(t,e,a){},c8a2:function(t,e,a){},f22c:function(t,e,a){"use strict";var i=a("c19c"),s=a.n(i);s.a},fb98:function(t,e,a){"use strict";var i=a("c8a2"),s=a.n(i);s.a}});
//# sourceMappingURL=player1.js.map